# Migration `watch-20191030101724`

This migration has been generated by Thor Anderson at 10/30/2019, 10:17:25 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."User" (
  "email" text NOT NULL DEFAULT '' ,
  "id" text NOT NULL  ,
  "name" text   ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."Post" (
  "id" text NOT NULL  ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."CFPackage" (
  "id" text NOT NULL  ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."CFDefinition" (
  "id" text NOT NULL  ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."CFConcept" (
  "description" text NOT NULL DEFAULT '' ,
  "hierarchyCode" text NOT NULL DEFAULT '' ,
  "id" text NOT NULL  ,
  "identifier" text NOT NULL DEFAULT '' ,
  "keywords" text NOT NULL DEFAULT '' ,
  "lastChangeDateTime" timestamp(3) NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "title" text NOT NULL DEFAULT '' ,
  "uri" text NOT NULL DEFAULT '' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."CFSubject" (
  "description" text NOT NULL DEFAULT '' ,
  "hierarchyCode" text NOT NULL DEFAULT '' ,
  "id" text NOT NULL  ,
  "identifier" text NOT NULL DEFAULT '' ,
  "lastChangeDateTime" timestamp(3) NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "title" text NOT NULL DEFAULT '' ,
  "uri" text NOT NULL DEFAULT '' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."CFLicense" (
  "description" text NOT NULL DEFAULT '' ,
  "id" text NOT NULL  ,
  "identifier" text NOT NULL DEFAULT '' ,
  "keywords" text NOT NULL DEFAULT '' ,
  "lastChangeDateTime" timestamp(3) NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "licenseText" text NOT NULL DEFAULT '' ,
  "title" text NOT NULL DEFAULT '' ,
  "uri" text NOT NULL DEFAULT '' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."CFItemType" (
  "description" text NOT NULL DEFAULT '' ,
  "hierarchyCode" text NOT NULL DEFAULT '' ,
  "id" text NOT NULL  ,
  "identifier" text NOT NULL DEFAULT '' ,
  "lastChangeDateTime" timestamp(3) NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "title" text NOT NULL DEFAULT '' ,
  "typeCode" text NOT NULL DEFAULT '' ,
  "uri" text NOT NULL DEFAULT '' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."CFAssociationGrouping" (
  "description" text NOT NULL DEFAULT '' ,
  "id" text NOT NULL  ,
  "identifier" text NOT NULL DEFAULT '' ,
  "lastChangeDateTime" timestamp(3) NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "title" text NOT NULL DEFAULT '' ,
  "uri" text NOT NULL DEFAULT '' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."CFDocument" (
  "adoptionStatus" text NOT NULL DEFAULT '' ,
  "creator" text NOT NULL DEFAULT '' ,
  "description" text NOT NULL DEFAULT '' ,
  "id" text NOT NULL  ,
  "identifier" text NOT NULL DEFAULT '' ,
  "language" text NOT NULL DEFAULT '' ,
  "lastChangeDateTime" timestamp(3) NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "notes" text NOT NULL DEFAULT '' ,
  "officialSourceURL" text NOT NULL DEFAULT '' ,
  "publisher" text NOT NULL DEFAULT '' ,
  "statusEndDate" timestamp(3) NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "statusStartDate" timestamp(3) NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "title" text NOT NULL DEFAULT '' ,
  "uri" text NOT NULL DEFAULT '' ,
  "version" text NOT NULL DEFAULT '' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."CFItem" (
  "abbreviatedStatement" text NOT NULL DEFAULT '' ,
  "alternativeLabel" text NOT NULL DEFAULT '' ,
  "fullStatement" text NOT NULL DEFAULT '' ,
  "humanCodingScheme" text NOT NULL DEFAULT '' ,
  "id" text NOT NULL  ,
  "identifier" text NOT NULL DEFAULT '' ,
  "language" text NOT NULL DEFAULT '' ,
  "listEnumeration" text NOT NULL DEFAULT '' ,
  "notes" text NOT NULL DEFAULT '' ,
  "statusEndDate" timestamp(3) NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "statusStartDate" timestamp(3) NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "uri" text NOT NULL DEFAULT '' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."LinkURI" (
  "id" text NOT NULL  ,
  "identifier" text NOT NULL DEFAULT '' ,
  "title" text NOT NULL DEFAULT '' ,
  "uri" text NOT NULL DEFAULT '' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."CFPackageURI" (
  "id" text NOT NULL  ,
  "identifier" text NOT NULL DEFAULT '' ,
  "title" text NOT NULL DEFAULT '' ,
  "uri" text NOT NULL DEFAULT '' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."LicenseURI" (
  "id" text NOT NULL  ,
  "identifier" text NOT NULL DEFAULT '' ,
  "title" text NOT NULL DEFAULT '' ,
  "uri" text NOT NULL DEFAULT '' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."CFItemTypeURI" (
  "id" text NOT NULL  ,
  "identifier" text NOT NULL DEFAULT '' ,
  "title" text NOT NULL DEFAULT '' ,
  "uri" text NOT NULL DEFAULT '' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."ConceptKeywordsURI" (
  "id" text NOT NULL  ,
  "identifier" text NOT NULL DEFAULT '' ,
  "title" text NOT NULL DEFAULT '' ,
  "uri" text NOT NULL DEFAULT '' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."CFAssociation" (
  "associationType" text NOT NULL DEFAULT 'IsChildOf' ,
  "id" text NOT NULL  ,
  "identifier" text NOT NULL DEFAULT '' ,
  "sequenceNumber" integer NOT NULL DEFAULT 0 ,
  "uri" text NOT NULL DEFAULT '' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."CFRubric" (
  "description" text NOT NULL DEFAULT '' ,
  "id" text NOT NULL  ,
  "identifier" text NOT NULL DEFAULT '' ,
  "lastChangeDateTime" timestamp(3) NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "title" text NOT NULL DEFAULT '' ,
  "uri" text NOT NULL DEFAULT '' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."CFRubricCriterion" (
  "category" text NOT NULL DEFAULT '' ,
  "description" text NOT NULL DEFAULT '' ,
  "id" text NOT NULL  ,
  "identifier" text NOT NULL DEFAULT '' ,
  "lastChangeDateTime" timestamp(3) NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "position" integer NOT NULL DEFAULT 0 ,
  "rubricId" text NOT NULL DEFAULT '' ,
  "uri" text NOT NULL DEFAULT '' ,
  "weight" integer NOT NULL DEFAULT 0 ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."CFRubricCriterionLevel" (
  "description" text NOT NULL DEFAULT '' ,
  "feedback" text NOT NULL DEFAULT '' ,
  "id" text NOT NULL  ,
  "identifier" text NOT NULL DEFAULT '' ,
  "lastChangeDateTime" timestamp(3) NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "position" integer NOT NULL DEFAULT 0 ,
  "quality" text NOT NULL DEFAULT '' ,
  "rubricCriterionId" text NOT NULL DEFAULT '' ,
  "score" integer NOT NULL DEFAULT 0 ,
  "uri" text NOT NULL DEFAULT '' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."LinkGenURI" (
  "id" text NOT NULL  ,
  "identifier" text NOT NULL DEFAULT '' ,
  "title" text NOT NULL DEFAULT '' ,
  "uri" text NOT NULL DEFAULT '' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."DestinationNodeURI" (
  "id" text NOT NULL  ,
  "identifier" text NOT NULL DEFAULT '' ,
  "title" text NOT NULL DEFAULT '' ,
  "uri" text NOT NULL DEFAULT '' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."CFAssociationGroupingURI" (
  "id" text NOT NULL  ,
  "identifier" text NOT NULL DEFAULT '' ,
  "title" text NOT NULL DEFAULT '' ,
  "uri" text NOT NULL DEFAULT '' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."CFDocument_subject" (
  "nodeId" text   REFERENCES "public"."CFDocument"("id") ON DELETE CASCADE,
  "position" integer NOT NULL  ,
  "value" text NOT NULL  ,
  PRIMARY KEY ("nodeId","position")
);

CREATE TABLE "public"."CFItem_conceptKeywords" (
  "nodeId" text   REFERENCES "public"."CFItem"("id") ON DELETE CASCADE,
  "position" integer NOT NULL  ,
  "value" text NOT NULL  ,
  PRIMARY KEY ("nodeId","position")
);

CREATE TABLE "public"."CFItem_educationLevel" (
  "nodeId" text   REFERENCES "public"."CFItem"("id") ON DELETE CASCADE,
  "position" integer NOT NULL  ,
  "value" text NOT NULL  ,
  PRIMARY KEY ("nodeId","position")
);

CREATE TABLE "public"."_UserBookmarks" (
  "A" text   REFERENCES "public"."Post"("id") ON DELETE CASCADE,
  "B" text   REFERENCES "public"."User"("id") ON DELETE CASCADE
);

ALTER TABLE "public"."Post" ADD COLUMN "author" text   REFERENCES "public"."User"("id") ON DELETE SET NULL;

ALTER TABLE "public"."CFPackage" ADD COLUMN "CFDocument" text   REFERENCES "public"."CFDocument"("id") ON DELETE SET NULL;

ALTER TABLE "public"."CFDefinition" ADD COLUMN "cFPackage" text   REFERENCES "public"."CFPackage"("id") ON DELETE SET NULL;

ALTER TABLE "public"."CFConcept" ADD COLUMN "cFDefinition" text   REFERENCES "public"."CFDefinition"("id") ON DELETE SET NULL;

ALTER TABLE "public"."CFSubject" ADD COLUMN "cFDefinition" text   REFERENCES "public"."CFDefinition"("id") ON DELETE SET NULL;

ALTER TABLE "public"."CFLicense" ADD COLUMN "cFDefinition" text   REFERENCES "public"."CFDefinition"("id") ON DELETE SET NULL;

ALTER TABLE "public"."CFItemType" ADD COLUMN "cFDefinition" text   REFERENCES "public"."CFDefinition"("id") ON DELETE SET NULL;

ALTER TABLE "public"."CFAssociationGrouping" ADD COLUMN "cFDefinition" text   REFERENCES "public"."CFDefinition"("id") ON DELETE SET NULL;

ALTER TABLE "public"."CFDocument" ADD COLUMN "CFPackageURI" text   REFERENCES "public"."CFPackageURI"("id") ON DELETE SET NULL,
ADD COLUMN "licenseURI" text   REFERENCES "public"."LicenseURI"("id") ON DELETE SET NULL;

ALTER TABLE "public"."CFItem" ADD COLUMN "CFItemType" text   REFERENCES "public"."CFItemType"("id") ON DELETE SET NULL,
ADD COLUMN "CFItemTypeURI" text   REFERENCES "public"."CFItemTypeURI"("id") ON DELETE SET NULL,
ADD COLUMN "cFPackage" text   REFERENCES "public"."CFPackage"("id") ON DELETE SET NULL,
ADD COLUMN "conceptKeywordsURI" text   REFERENCES "public"."ConceptKeywordsURI"("id") ON DELETE SET NULL,
ADD COLUMN "licenseURI" text   REFERENCES "public"."LinkURI"("id") ON DELETE SET NULL;

ALTER TABLE "public"."LinkURI" ADD COLUMN "cFDocument" text   REFERENCES "public"."CFDocument"("id") ON DELETE SET NULL;

ALTER TABLE "public"."CFAssociation" ADD COLUMN "CFAssociationGroupingURI" text   REFERENCES "public"."CFAssociationGroupingURI"("id") ON DELETE SET NULL,
ADD COLUMN "CFDocumentURI" text   REFERENCES "public"."LinkURI"("id") ON DELETE SET NULL,
ADD COLUMN "cFPackage" text   REFERENCES "public"."CFPackage"("id") ON DELETE SET NULL,
ADD COLUMN "destinationNodeURI" text   REFERENCES "public"."DestinationNodeURI"("id") ON DELETE SET NULL,
ADD COLUMN "originNodeURI" text   REFERENCES "public"."LinkGenURI"("id") ON DELETE SET NULL;

ALTER TABLE "public"."CFRubric" ADD COLUMN "cFPackage" text   REFERENCES "public"."CFPackage"("id") ON DELETE SET NULL;

ALTER TABLE "public"."CFRubricCriterion" ADD COLUMN "CFItemURI" text   REFERENCES "public"."LinkURI"("id") ON DELETE SET NULL,
ADD COLUMN "cFRubric" text   REFERENCES "public"."CFRubric"("id") ON DELETE SET NULL;

CREATE UNIQUE INDEX "User.email" ON "public"."User"("email")

CREATE UNIQUE INDEX "_UserBookmarks_AB_unique" ON "public"."_UserBookmarks"("A","B")
```

## Changes

```diff
diff --git datamodel.mdl datamodel.mdl
migration ..watch-20191030101724
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,255 @@
+datasource postgres {
+  provider = "postgresql"
+  url      = "postgresql://postgres:docker@localhost:5432"
+}
+
+generator photonjs {
+  provider = "photonjs"
+
+}
+
+
+model User {
+    id  String @default(cuid()) @id
+    email     String @unique
+    name      String?
+    posts     Post[] @relation(name: "UserPosts")
+    bookmarks Post[] @relation(name: "UserBookmarks")
+}
+
+model Post {
+    id            String @default(cuid()) @id
+    author        User? @relation(name: "UserPosts")
+    bookmarkedBy  User[] @relation(name: "UserBookmarks")
+}
+
+model CFPackage {
+  id  String @default(cuid()) @id
+  CFDocument CFDocument
+  CFItems CFItem[]
+  CFAssociations CFAssociation[]
+  CFDefinitions CFDefinition[]
+  CFRubrics CFRubric[]
+}
+
+model CFDefinition {
+  id  String @default(cuid()) @id
+  CFConcepts CFConcept[]
+  CFSubjects CFSubject[]
+  CFLicenses CFLicense[]
+  CFItemTypes CFItemType[]
+  CFAssociationGroupings CFAssociationGrouping[]
+}
+
+model CFConcept {
+  id  String @default(cuid()) @id
+  identifier String
+  title String
+  uri String
+  keywords String
+  description String
+  hierarchyCode String
+  lastChangeDateTime DateTime
+}
+
+model CFSubject {
+  id  String @default(cuid()) @id
+  identifier String
+  title String
+  uri String
+  description String
+  hierarchyCode String
+  lastChangeDateTime DateTime
+}
+
+model CFLicense {
+  id  String @default(cuid()) @id
+  identifier String
+  title String
+  uri String
+  keywords String
+  description String
+  licenseText String
+  lastChangeDateTime DateTime
+}
+
+model CFItemType {
+  id  String @default(cuid()) @id
+  identifier String
+  title String
+  uri String
+  description String
+  hierarchyCode String
+  typeCode String
+  lastChangeDateTime DateTime
+}
+
+model CFAssociationGrouping {
+  id  String @default(cuid()) @id
+  identifier String
+  title String
+  uri String
+  description String
+  lastChangeDateTime DateTime
+}
+
+model CFDocument {
+  id  String @default(cuid()) @id
+  identifier String
+  uri String
+  creator String
+  title String
+  lastChangeDateTime DateTime
+  CFPackageURI CFPackageURI
+  officialSourceURL String
+  publisher String
+  description String
+  subject String[]
+  subjectURI LinkURI[]
+  language String
+  version String
+  adoptionStatus String
+  statusStartDate DateTime
+  statusEndDate DateTime
+  licenseURI LicenseURI
+  notes String
+}
+
+model CFItem {
+  id  String @default(cuid()) @id
+  identifier String
+  uri String
+  fullStatement String
+  alternativeLabel String
+  CFItemType CFItemType
+  CFItemTypeURI CFItemTypeURI
+  humanCodingScheme String
+  listEnumeration String
+  abbreviatedStatement String
+  conceptKeywords String[]
+  conceptKeywordsURI ConceptKeywordsURI 
+  notes String
+  language String
+  educationLevel String[]
+  statusStartDate DateTime
+  statusEndDate DateTime
+  licenseURI LinkURI
+}
+
+model LinkURI {
+  id  String @default(cuid()) @id
+  identifier String
+  title String
+  uri String
+}
+
+model CFPackageURI {
+  id  String @default(cuid()) @id
+  identifier String
+  title String
+  uri String
+}
+
+model LicenseURI {
+  id  String @default(cuid()) @id
+  identifier String
+  title String
+  uri String
+}
+
+model CFItemTypeURI {
+  id  String @default(cuid()) @id
+  identifier String
+  title String
+  uri String
+}
+
+model ConceptKeywordsURI {
+  id  String @default(cuid()) @id
+  identifier String
+  title String
+  uri String
+}
+
+model CFAssociation {
+  id  String @default(cuid()) @id
+  identifier String
+  uri String
+  CFDocumentURI LinkURI
+  associationType CFAssociationTypeEnum
+  sequenceNumber Int
+  originNodeURI LinkGenURI
+  destinationNodeURI DestinationNodeURI
+  CFAssociationGroupingURI CFAssociationGroupingURI
+}
+
+model CFRubric {
+  id  String @default(cuid()) @id
+  identifier String
+  title String
+  uri String
+  description String
+  lastChangeDateTime DateTime
+  CFRubricCriteria CFRubricCriterion[]
+}
+
+model CFRubricCriterion {
+  id  String @default(cuid()) @id
+  identifier String
+  category String
+  uri String
+  description String
+  CFItemURI LinkURI
+  weight Int
+  position Int
+  rubricId String
+  lastChangeDateTime DateTime
+}
+
+model CFRubricCriterionLevel {
+  id  String @default(cuid()) @id
+  identifier String
+  quality String
+  uri String
+  description String
+  score Int
+  feedback String
+  position Int
+  rubricCriterionId String
+  lastChangeDateTime DateTime
+}
+
+model LinkGenURI {
+  id  String @default(cuid()) @id
+  identifier String
+  title String
+  uri String
+  originNodeURIs CFAssociation
+}
+
+model DestinationNodeURI {
+  id  String @default(cuid()) @id
+  identifier String
+  title String
+  uri String
+  originNodeURIs CFAssociation
+}
+model CFAssociationGroupingURI {
+  id  String @default(cuid()) @id
+  identifier String
+  title String
+  uri String
+  originNodeURIs CFAssociation
+}
+
+enum CFAssociationTypeEnum {
+  IsChildOf
+  IsPeerOf
+  IsPartOf
+  ExactMatchOf
+  Precedes
+  IsRelatedTo
+  ReplacedBy
+  Exemplar
+  HasSkillLevel
+}
```

## Photon Usage

You can use a specific Photon built for this migration (watch-20191030101724)
in your `before` or `after` migration script like this:

```ts
import Photon from '@generated/photon/watch-20191030101724'

const photon = new Photon()

async function main() {
  const result = await photon.users()
  console.dir(result, { depth: null })
}

main()

```
